<div class="min-h-screen flex items-center justify-center bg-stone-50 p-4">
  <div class="relative mx-auto w-full max-w-md bg-white px-6 pt-10 pb-8 shadow-xl ring-1 ring-stone-200 sm:rounded-xl sm:px-10">
    <div class="w-full">
      <div class="text-center">
        <h1 class="text-2xl font-extrabold text-stone-800">Регистрация</h1>
      </div>
      <div class="mt-5">
        <% if @user.errors.any? %>
          <div class="mb-4 p-3 bg-red-50 border border-red-200 rounded">
            <ul class="space-y-1">
              <% @user.errors.full_messages.each do |message| %>
                <li class="text-red-600 text-sm"><%= message %></li>
              <% end %>
            </ul>
          </div>
        <% end %>
        
        <%= form_with model: @user, url: registrations_path, id: "registration-form" do |form| %>
          <div class="relative mt-6">
            <%= form.email_field :email_address, required: true, autofocus: true, autocomplete: "username", placeholder: "Электронная почта", 
                class: "peer mt-1 w-full border-0 border-b-2 #{@user.errors[:email_address].any? ? 'border-red-300' : 'border-stone-200'} bg-transparent placeholder:text-transparent focus:border-amber-600 focus:outline-none focus:ring-0 text-stone-800" %>
            <label for="user_email_address" class="pointer-events-none absolute top-0 left-0 origin-left -translate-y-1/2 transform text-sm text-stone-800 opacity-75 transition-all duration-100 ease-in-out peer-placeholder-shown:top-1/2 peer-placeholder-shown:text-base peer-placeholder-shown:text-stone-500 peer-focus:top-0 peer-focus:pl-0 peer-focus:text-sm peer-focus:text-amber-600">
              Электронная почта
            </label>
          </div>
          
          <div class="relative mt-6">
            <%= form.password_field :password, required: true, autocomplete: "new-password", placeholder: "Пароль", 
                class: "password-field peer mt-1 w-full border-0 border-b-2 #{@user.errors[:password].any? ? 'border-red-300' : 'border-stone-200'} bg-transparent placeholder:text-transparent focus:border-amber-600 focus:outline-none focus:ring-0 text-stone-800" %>
            <label for="user_password" class="pointer-events-none absolute top-0 left-0 origin-left -translate-y-1/2 transform text-sm text-stone-800 opacity-75 transition-all duration-100 ease-in-out peer-placeholder-shown:top-1/2 peer-placeholder-shown:text-base peer-placeholder-shown:text-stone-500 peer-focus:top-0 peer-focus:pl-0 peer-focus:text-sm peer-focus:text-amber-600">
              Пароль
            </label>
          </div>
          
          <div class="relative mt-6">
            <%= form.password_field :password_confirmation, required: true, autocomplete: "new-password", placeholder: "Подтвердите пароль", 
                class: "password-confirmation-field peer mt-1 w-full border-0 border-b-2 #{@user.errors[:password_confirmation].any? ? 'border-red-300' : 'border-stone-200'} bg-transparent placeholder:text-transparent focus:border-amber-600 focus:outline-none focus:ring-0 text-stone-800" %>
            <label for="user_password_confirmation" class="pointer-events-none absolute top-0 left-0 origin-left -translate-y-1/2 transform text-sm text-stone-800 opacity-75 transition-all duration-100 ease-in-out peer-placeholder-shown:top-1/2 peer-placeholder-shown:text-base peer-placeholder-shown:text-stone-500 peer-focus:top-0 peer-focus:pl-0 peer-focus:text-sm peer-focus:text-amber-600">
              Еще раз пароль
            </label>
            <div id="password-match-error" class="hidden mt-1 text-xs text-red-600">
              Пароли не совпадают
            </div>
          </div>
          
          <div class="my-6">
            <%= form.submit "Зарегистрироваться", 
                class: "w-full rounded-md bg-amber-600 px-3 py-4 text-white font-semibold hover:bg-amber-500 focus:bg-amber-500 focus:outline-none transition-colors cursor-pointer" %>
          </div>
        <% end %>
        
        <p class="text-center text-sm text-stone-600 mt-4">
          Уже есть аккаунт? 
          <%= link_to "Войти", new_session_path, 
              class: "font-semibold text-amber-600 hover:text-amber-500 hover:underline focus:text-amber-500 focus:outline-none transition-colors" %>
        </p>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const form = document.getElementById('registration-form');
  const passwordField = form.querySelector('.password-field');
  const confirmationField = form.querySelector('.password-confirmation-field');
  const errorMessage = document.getElementById('password-match-error');
  const submitButton = form.querySelector('input[type="submit"]');
  
  function checkPasswordMatch() {
    const password = passwordField.value;
    const confirmation = confirmationField.value;
    
    if (confirmation === '') {
      errorMessage.classList.add('hidden');
      confirmationField.classList.remove('border-red-300');
      confirmationField.classList.add('border-stone-200');
      return true;
    }
    
    if (password === confirmation) {
      errorMessage.classList.add('hidden');
      confirmationField.classList.remove('border-red-300');
      confirmationField.classList.add('border-stone-200');
      return true;
    } else {
      errorMessage.classList.remove('hidden');
      confirmationField.classList.remove('border-stone-200');
      confirmationField.classList.add('border-red-300');
      return false;
    }
  }
  
  function validateForm() {
    const isValid = checkPasswordMatch();
    submitButton.disabled = !isValid;
    return isValid;
  }
  
  passwordField.addEventListener('input', checkPasswordMatch);
  confirmationField.addEventListener('input', checkPasswordMatch);
  
  form.addEventListener('submit', function(e) {
    if (!checkPasswordMatch()) {
      e.preventDefault();
      confirmationField.focus();
    }
  });
  
  checkPasswordMatch();
});
</script>